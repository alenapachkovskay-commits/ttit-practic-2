{% extends "base_generic.html" %}

{% block title %}Мои заявки{% endblock %}

{% block content %}
<h1 class="page-title">Мои заявки</h1>

<form method="get" class="filter-form">
    <label for="status" class="filter-label">Фильтр по статусу:</label>
    <select name="status" id="status" class="filter-select">
        <option value="">Все</option>
        <option value="new" {% if status_filter == "new" %}selected{% endif %}>Новая</option>
        <option value="in_progress" {% if status_filter == "in_progress" %}selected{% endif %}>Принято в работу</option>
        <option value="completed" {% if status_filter == "completed" %}selected{% endif %}>Выполнено</option>
    </select>
    <button type="submit" class="btn">Применить</button>
</form>

{% if requests %}
    <ul class="requests-list">
        {% for req in requests %}
        <li class="request-item">
            <strong>{{ req.title }}</strong> ({{ req.get_status_display }})
            — {{ req.created_at|date:"d.m.Y H:i" }}
            <a href="{% url 'request-detail' req.id %}" class="table-link">Просмотр</a>
            {% if req.can_be_deleted %}
                <a href="{% url 'delete_request' req.id %}" class="delete-link">Удалить</a>
            {% endif %}
        </li>
        {% endfor %}
    </ul>
{% else %}
    <p class="no-requests">У вас пока нет заявок.</p>
{% endif %}

<a href="{% url 'create_request' %}" class="add-link">Создать новую заявку</a>
{% endblock %}